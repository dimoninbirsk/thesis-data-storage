<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ColorExtensions.cs</title>
  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>
<pre><code class = "cs">
<a name="ln1">using System;</a>
<a name="ln2">using System.Collections.Generic;</a>
<a name="ln3">using System.Linq;</a>
<a name="ln4">using System.Threading.Tasks;</a>
<a name="ln5">using System.Windows.Media;</a>
<a name="ln6">using ScreenToGif.Controls;</a>
<a name="ln7"> </a>
<a name="ln8">namespace ScreenToGif.Util;</a>
<a name="ln9"> </a>
<a name="ln10">internal static class ColorExtensions</a>
<a name="ln11">{</a>
<a name="ln12">    public static bool IsEnoughContrast(this Color color1, Color color2)</a>
<a name="ln13">    {</a>
<a name="ln14">        Console.WriteLine(GetBrightness(color1) + &quot;: &quot; + GetBrightness2(color1) + &quot; - &quot; + GetBrightness2(color2) + &quot; = &quot; + Math.Abs(GetBrightness2(color1) - GetBrightness2(color2)));</a>
<a name="ln15"> </a>
<a name="ln16">        return Math.Abs(GetBrightness2(color1) - GetBrightness2(color2)) &gt; 125;</a>
<a name="ln17">    }</a>
<a name="ln18"> </a>
<a name="ln19">    public static int GetBrightness4(this Color color)</a>
<a name="ln20">    {</a>
<a name="ln21">        return color.R + (2*color.G) + color.B;</a>
<a name="ln22">    }</a>
<a name="ln23"> </a>
<a name="ln24">    public static float GetBrightness3(this Color color)</a>
<a name="ln25">    {</a>
<a name="ln26">        var num = color.R / 255f;</a>
<a name="ln27">        var num2 = color.G / 255f;</a>
<a name="ln28">        var num3 = color.B / 255f;</a>
<a name="ln29">        var num4 = num;</a>
<a name="ln30">        var num5 = num;</a>
<a name="ln31">        if (num2 &gt; num4)</a>
<a name="ln32">            num4 = num2;</a>
<a name="ln33">        if (num3 &gt; num4)</a>
<a name="ln34">            num4 = num3;</a>
<a name="ln35">        if (num2 &lt; num5)</a>
<a name="ln36">            num5 = num2;</a>
<a name="ln37">        if (num3 &lt; num5)</a>
<a name="ln38">            num5 = num3;</a>
<a name="ln39">        return (num4 + num5) / 2f;</a>
<a name="ln40">    }</a>
<a name="ln41"> </a>
<a name="ln42">    public static double GetBrightness2(this Color c)</a>
<a name="ln43">    {</a>
<a name="ln44">        return 0.2126 * c.R + 0.7152 * c.G + 0.0722 * c.B;</a>
<a name="ln45">        //return (0.299*c.R + 0.587*c.G + 0.114*c.B);</a>
<a name="ln46">    }</a>
<a name="ln47"> </a>
<a name="ln48">    public static int GetBrightness1(this Color c)</a>
<a name="ln49">    {</a>
<a name="ln50">        return (int)Math.Sqrt(</a>
<a name="ln51">            c.R * c.R * .241 +</a>
<a name="ln52">            c.G * c.G * .691 +</a>
<a name="ln53">            c.B * c.B * .068);</a>
<a name="ln54">    }</a>
<a name="ln55"> </a>
<a name="ln56">    public static int GetBrightness(this Color c)</a>
<a name="ln57">    {</a>
<a name="ln58">        return (2 * c.R) + (5 * c.G) + c.B;</a>
<a name="ln59">    }</a>
<a name="ln60"> </a>
<a name="ln61">    public static float GetHue(this Color color)</a>
<a name="ln62">    {</a>
<a name="ln63">        if ((color.R == color.G) &amp;&amp; (color.G == color.B))</a>
<a name="ln64">            return 0f;</a>
<a name="ln65">        var num = color.R / 255f;</a>
<a name="ln66">        var num2 = color.G / 255f;</a>
<a name="ln67">        var num3 = color.B / 255f;</a>
<a name="ln68">        var num7 = 0f;</a>
<a name="ln69">        var num4 = num;</a>
<a name="ln70">        var num5 = num;</a>
<a name="ln71">        if (num2 &gt; num4)</a>
<a name="ln72">            num4 = num2;</a>
<a name="ln73">        if (num3 &gt; num4)</a>
<a name="ln74">            num4 = num3;</a>
<a name="ln75">        if (num2 &lt; num5)</a>
<a name="ln76">            num5 = num2;</a>
<a name="ln77">        if (num3 &lt; num5)</a>
<a name="ln78">            num5 = num3;</a>
<a name="ln79">        var num6 = num4 - num5;</a>
<a name="ln80">        if (num == num4)</a>
<a name="ln81">            num7 = (num2 - num3) / num6;</a>
<a name="ln82">        else if (num2 == num4)</a>
<a name="ln83">            num7 = 2f + (num3 - num) / num6;</a>
<a name="ln84">        else if (num3 == num4)</a>
<a name="ln85">            num7 = 4f + (num - num2) / num6;</a>
<a name="ln86">        num7 *= 60f;</a>
<a name="ln87">        if (num7 &lt; 0f)</a>
<a name="ln88">            num7 += 360f;</a>
<a name="ln89">        return num7;</a>
<a name="ln90">    }</a>
<a name="ln91"> </a>
<a name="ln92">    public static float GetSaturation(this Color color)</a>
<a name="ln93">    {</a>
<a name="ln94">        var num = color.R / 255f;</a>
<a name="ln95">        var num2 = color.G / 255f;</a>
<a name="ln96">        var num3 = color.B / 255f;</a>
<a name="ln97"> </a>
<a name="ln98">        var num7 = 0f;</a>
<a name="ln99">        var num4 = num;</a>
<a name="ln100">        var num5 = num;</a>
<a name="ln101">        if (num2 &gt; num4)</a>
<a name="ln102">            num4 = num2;</a>
<a name="ln103">        if (num3 &gt; num4)</a>
<a name="ln104">            num4 = num3;</a>
<a name="ln105">        if (num2 &lt; num5)</a>
<a name="ln106">            num5 = num2;</a>
<a name="ln107">        if (num3 &lt; num5)</a>
<a name="ln108">            num5 = num3;</a>
<a name="ln109">        if (num4 == num5)</a>
<a name="ln110">            return num7;</a>
<a name="ln111"> </a>
<a name="ln112">        var num6 = (num4 + num5) / 2f;</a>
<a name="ln113">        if (num6 &lt;= 0.5)</a>
<a name="ln114">            return (num4 - num5) / (num4 + num5);</a>
<a name="ln115">        return (num4 - num5) / (2f - num4 - num5);</a>
<a name="ln116">    }</a>
<a name="ln117"> </a>
<a name="ln118"> </a>
<a name="ln119">    #region Color Comparison</a>
<a name="ln120"> </a>
<a name="ln121">    /// &lt;summary&gt;</a>
<a name="ln122">    /// Closest match for hues only.</a>
<a name="ln123">    /// &lt;/summary&gt;</a>
<a name="ln124">    /// &lt;param name=&quot;colors&quot;&gt;&lt;/param&gt;</a>
<a name="ln125">    /// &lt;param name=&quot;target&quot;&gt;&lt;/param&gt;</a>
<a name="ln126">    /// &lt;returns&gt;&lt;/returns&gt;</a>
<a name="ln127">    public static int ClosestColorHue(List&lt;Color&gt; colors, Color target)</a>
<a name="ln128">    {</a>
<a name="ln129">        var hue1 = target.GetHue();</a>
<a name="ln130">        var diffs = colors.Select(n =&gt; GetHueDistance(n.GetHue(), hue1));</a>
<a name="ln131">        var diffMin = diffs.Min(n =&gt; n);</a>
<a name="ln132"> </a>
<a name="ln133">        return diffs.ToList().FindIndex(n =&gt; n == diffMin);</a>
<a name="ln134">    }</a>
<a name="ln135"> </a>
<a name="ln136">    /// &lt;summary&gt;</a>
<a name="ln137">    /// Closest match in RGB space.</a>
<a name="ln138">    /// &lt;/summary&gt;</a>
<a name="ln139">    /// &lt;param name=&quot;colors&quot;&gt;&lt;/param&gt;</a>
<a name="ln140">    /// &lt;param name=&quot;target&quot;&gt;&lt;/param&gt;</a>
<a name="ln141">    /// &lt;returns&gt;&lt;/returns&gt;</a>
<a name="ln142">    public static int ClosestColorRgb(List&lt;Color&gt; colors, Color target)</a>
<a name="ln143">    {</a>
<a name="ln144">        //var colorDiffs = colors.AsParallel().Select(n =&gt; ColorDiff(n, target)).Min(n =&gt; n);</a>
<a name="ln145">        //return colors.FindIndex(n =&gt; ColorDiff(n, target) == colorDiffs);</a>
<a name="ln146"> </a>
<a name="ln147">        var distance = int.MaxValue;</a>
<a name="ln148">        var indexOfMin = -1;</a>
<a name="ln149">        Parallel.For(0, colors.Count, (i, x) =&gt;</a>
<a name="ln150">        {</a>
<a name="ln151">            var diff = ColorDiff(colors[i], target);</a>
<a name="ln152"> </a>
<a name="ln153">            if (diff &lt; distance)</a>
<a name="ln154">            {</a>
<a name="ln155">                distance = diff;</a>
<a name="ln156">                indexOfMin = i;</a>
<a name="ln157">            }</a>
<a name="ln158"> </a>
<a name="ln159">            if (distance == 0)</a>
<a name="ln160">                x.Break();</a>
<a name="ln161">        });</a>
<a name="ln162"> </a>
<a name="ln163">        return indexOfMin;</a>
<a name="ln164"> </a>
<a name="ln165">        //return colors.AsParallel().Select(n=&gt; ColorDiff(n, target)).IndexOfMin();</a>
<a name="ln166">    }</a>
<a name="ln167"> </a>
<a name="ln168">    public static int IndexOfMin&lt;T&gt;(this IEnumerable&lt;T&gt; list) where T : IComparable</a>
<a name="ln169">    {</a>
<a name="ln170">        //or</a>
<a name="ln171">        /* int min = self[0];</a>
<a name="ln172">           int minIndex = 0;</a>
<a name="ln173"> </a>
<a name="ln174">           for (int i = 1; i &lt; self.Count; ++i) {</a>
<a name="ln175">               if (self[i] &lt; min) {</a>
<a name="ln176">                   min = self[i];</a>
<a name="ln177">                   minIndex = i;</a>
<a name="ln178">               }</a>
<a name="ln179">           }*/</a>
<a name="ln180"> </a>
<a name="ln181">        var enumerator = list.GetEnumerator();</a>
<a name="ln182">        enumerator.MoveNext();</a>
<a name="ln183"> </a>
<a name="ln184">        var minValue = enumerator.Current;</a>
<a name="ln185"> </a>
<a name="ln186">        var minOffset = 0;</a>
<a name="ln187">        for (var i = 1; enumerator.MoveNext(); ++i)</a>
<a name="ln188">        {</a>
<a name="ln189">            if (enumerator.Current.CompareTo(minValue) &gt;= 0)</a>
<a name="ln190">                continue;</a>
<a name="ln191"> </a>
<a name="ln192">            minValue = enumerator.Current;</a>
<a name="ln193">            minOffset = i;</a>
<a name="ln194">        }</a>
<a name="ln195"> </a>
<a name="ln196">        return minOffset;</a>
<a name="ln197">    }</a>
<a name="ln198"> </a>
<a name="ln199">    /// &lt;summary&gt;</a>
<a name="ln200">    /// Weighed distance using hue, saturation and brightness.</a>
<a name="ln201">    /// &lt;/summary&gt;</a>
<a name="ln202">    /// &lt;param name=&quot;colors&quot;&gt;&lt;/param&gt;</a>
<a name="ln203">    /// &lt;param name=&quot;target&quot;&gt;&lt;/param&gt;</a>
<a name="ln204">    /// &lt;returns&gt;&lt;/returns&gt;</a>
<a name="ln205">    public static int ClosestColorHsb(List&lt;Color&gt; colors, Color target)</a>
<a name="ln206">    {</a>
<a name="ln207">        var hue1 = target.GetHue();</a>
<a name="ln208">        var num1 = ColorNum(target);</a>
<a name="ln209">        var diffs = colors.Select(n =&gt; Math.Abs(ColorNum(n) - num1) +</a>
<a name="ln210">                                       GetHueDistance(n.GetHue(), hue1));</a>
<a name="ln211">        var diffMin = diffs.Min(x =&gt; x);</a>
<a name="ln212">        return diffs.ToList().FindIndex(n =&gt; n == diffMin);</a>
<a name="ln213">    }</a>
<a name="ln214"> </a>
<a name="ln215">    /// &lt;summary&gt;</a>
<a name="ln216">    /// Color brightness as perceived.</a>
<a name="ln217">    /// &lt;/summary&gt;</a>
<a name="ln218">    /// &lt;param name=&quot;c&quot;&gt;The Color&lt;/param&gt;</a>
<a name="ln219">    /// &lt;returns&gt;The brightness.&lt;/returns&gt;</a>
<a name="ln220">    public static float GetLuminance(Color c)</a>
<a name="ln221">    {</a>
<a name="ln222">        return (c.R * 0.299f + c.G * 0.587f + c.B * 0.114f) / 256f;</a>
<a name="ln223">    }</a>
<a name="ln224"> </a>
<a name="ln225">    /// &lt;summary&gt;</a>
<a name="ln226">    /// Gets the distance between two hues.</a>
<a name="ln227">    /// &lt;/summary&gt;</a>
<a name="ln228">    /// &lt;param name=&quot;hue1&quot;&gt;Hue 1&lt;/param&gt;</a>
<a name="ln229">    /// &lt;param name=&quot;hue2&quot;&gt;Hue 2&lt;/param&gt;</a>
<a name="ln230">    /// &lt;returns&gt;The distance.&lt;/returns&gt;</a>
<a name="ln231">    public static float GetHueDistance(float hue1, float hue2)</a>
<a name="ln232">    {</a>
<a name="ln233">        var d = Math.Abs(hue1 - hue2); return d &gt; 180 ? 360 - d : d;</a>
<a name="ln234">    }</a>
<a name="ln235"> </a>
<a name="ln236">    public static float ColorNum(Color c)</a>
<a name="ln237">    {</a>
<a name="ln238">        var factorSat = 3;</a>
<a name="ln239">        var factorBri = 3;</a>
<a name="ln240">        return c.GetSaturation() * factorSat + GetBrightness(c) * factorBri;</a>
<a name="ln241">    }</a>
<a name="ln242"> </a>
<a name="ln243">    /// &lt;summary&gt;</a>
<a name="ln244">    /// Gets the distance in the RGB space.</a>
<a name="ln245">    /// &lt;/summary&gt;</a>
<a name="ln246">    /// &lt;param name=&quot;first&quot;&gt;Color 1&lt;/param&gt;</a>
<a name="ln247">    /// &lt;param name=&quot;second&quot;&gt;Color 2&lt;/param&gt;</a>
<a name="ln248">    /// &lt;returns&gt;The distance.&lt;/returns&gt;</a>
<a name="ln249">    public static int ColorDiff(Color first, Color second)</a>
<a name="ln250">    {</a>
<a name="ln251">        return (int)Math.Sqrt((first.R - second.R) * (first.R - second.R) + (first.G - second.G) * (first.G - second.G) + (first.B - second.B) * (first.B - second.B));</a>
<a name="ln252">    }</a>
<a name="ln253"> </a>
<a name="ln254">    #endregion</a>
<a name="ln255"> </a>
<a name="ln256">    /// &lt;summary&gt;</a>
<a name="ln257">    /// Converts an RGB color to an HSV color</a>
<a name="ln258">    /// &lt;/summary&gt;</a>
<a name="ln259">    /// &lt;param name=&quot;color&quot;&gt;Color&lt;/param&gt;</a>
<a name="ln260">    /// &lt;returns&gt;A HsvColor object.&lt;/returns&gt;</a>
<a name="ln261">    public static HsvColor ConvertRgbToHsv(this Color color)</a>
<a name="ln262">    {</a>
<a name="ln263">        double h = 0, s;</a>
<a name="ln264"> </a>
<a name="ln265">        double min = Math.Min(Math.Min(color.R, color.G), color.B);</a>
<a name="ln266">        double v = Math.Max(Math.Max(color.R, color.G), color.B);</a>
<a name="ln267">        var delta = v - min;</a>
<a name="ln268"> </a>
<a name="ln269">        if (v == 0.0)</a>
<a name="ln270">            s = 0;</a>
<a name="ln271">        else</a>
<a name="ln272">            s = delta / v;</a>
<a name="ln273"> </a>
<a name="ln274">        if (s == 0)</a>
<a name="ln275">            h = 0.0;</a>
<a name="ln276">        else</a>
<a name="ln277">        {</a>
<a name="ln278">            if (color.R == v)</a>
<a name="ln279">                h = (color.G - color.B) / delta;</a>
<a name="ln280">            else if (color.G == v)</a>
<a name="ln281">                h = 2 + (color.B - color.R) / delta;</a>
<a name="ln282">            else if (color.B == v)</a>
<a name="ln283">                h = 4 + (color.R - color.G) / delta;</a>
<a name="ln284"> </a>
<a name="ln285">            h *= 60;</a>
<a name="ln286">            if (h &lt; 0.0)</a>
<a name="ln287">                h = h + 360;</a>
<a name="ln288">        }</a>
<a name="ln289"> </a>
<a name="ln290">        var hsvColor = new HsvColor();</a>
<a name="ln291">        hsvColor.H = h;</a>
<a name="ln292">        hsvColor.S = s;</a>
<a name="ln293">        hsvColor.V = v / 255;</a>
<a name="ln294"> </a>
<a name="ln295">        return hsvColor;</a>
<a name="ln296">    }</a>
<a name="ln297"> </a>
<a name="ln298">    /// &lt;summary&gt;</a>
<a name="ln299">    /// Converts an RGB color to an HSV color</a>
<a name="ln300">    /// &lt;/summary&gt;</a>
<a name="ln301">    /// &lt;param name=&quot;r&quot;&gt;Red&lt;/param&gt;</a>
<a name="ln302">    /// &lt;param name=&quot;b&quot;&gt;Blue&lt;/param&gt;</a>
<a name="ln303">    /// &lt;param name=&quot;g&quot;&gt;Green&lt;/param&gt;</a>
<a name="ln304">    /// &lt;returns&gt;A HsvColor object.&lt;/returns&gt;</a>
<a name="ln305">    public static HsvColor ConvertRgbToHsv(int r, int g, int b)</a>
<a name="ln306">    {</a>
<a name="ln307">        double h = 0, s;</a>
<a name="ln308"> </a>
<a name="ln309">        double min = Math.Min(Math.Min(r, g), b);</a>
<a name="ln310">        double v = Math.Max(Math.Max(r, g), b);</a>
<a name="ln311">        var delta = v - min;</a>
<a name="ln312"> </a>
<a name="ln313">        if (v == 0.0)</a>
<a name="ln314">            s = 0;</a>
<a name="ln315">        else</a>
<a name="ln316">            s = delta / v;</a>
<a name="ln317"> </a>
<a name="ln318">        if (s == 0)</a>
<a name="ln319">            h = 0.0;</a>
<a name="ln320">        else</a>
<a name="ln321">        {</a>
<a name="ln322">            if (r == v)</a>
<a name="ln323">                h = (g - b) / delta;</a>
<a name="ln324">            else if (g == v)</a>
<a name="ln325">                h = 2 + (b - r) / delta;</a>
<a name="ln326">            else if (b == v)</a>
<a name="ln327">                h = 4 + (r - g) / delta;</a>
<a name="ln328"> </a>
<a name="ln329">            h *= 60;</a>
<a name="ln330">            if (h &lt; 0.0)</a>
<a name="ln331">                h = h + 360;</a>
<a name="ln332">        }</a>
<a name="ln333"> </a>
<a name="ln334">        var hsvColor = new HsvColor();</a>
<a name="ln335">        hsvColor.H = h;</a>
<a name="ln336">        hsvColor.S = s;</a>
<a name="ln337">        hsvColor.V = v / 255;</a>
<a name="ln338"> </a>
<a name="ln339">        return hsvColor;</a>
<a name="ln340">    }</a>
<a name="ln341"> </a>
<a name="ln342">    /// &lt;summary&gt;</a>
<a name="ln343">    /// Converts an HSV color to an RGB color.</a>
<a name="ln344">    /// &lt;/summary&gt;</a>
<a name="ln345">    /// &lt;param name=&quot;h&quot;&gt;Hue&lt;/param&gt;</a>
<a name="ln346">    /// &lt;param name=&quot;s&quot;&gt;Saturation&lt;/param&gt;</a>
<a name="ln347">    /// &lt;param name=&quot;v&quot;&gt;Value&lt;/param&gt;</a>
<a name="ln348">    /// &lt;param name=&quot;alpha&quot;&gt;Alpha&lt;/param&gt;</a>
<a name="ln349">    /// &lt;returns&gt;&lt;/returns&gt;</a>
<a name="ln350">    public static Color ConvertHsvToRgb(double h, double s, double v, double alpha)</a>
<a name="ln351">    {</a>
<a name="ln352">        double r, g, b;</a>
<a name="ln353"> </a>
<a name="ln354">        if (s == 0)</a>
<a name="ln355">        {</a>
<a name="ln356">            r = v;</a>
<a name="ln357">            g = v;</a>
<a name="ln358">            b = v;</a>
<a name="ln359">        }</a>
<a name="ln360">        else</a>
<a name="ln361">        {</a>
<a name="ln362">            if (h == 360)</a>
<a name="ln363">                h = 0;</a>
<a name="ln364">            else</a>
<a name="ln365">                h = h / 60;</a>
<a name="ln366"> </a>
<a name="ln367">            var i = (int)Math.Truncate(h);</a>
<a name="ln368">            var f = h - i;</a>
<a name="ln369"> </a>
<a name="ln370">            var p = v * (1.0 - s);</a>
<a name="ln371">            var q = v * (1.0 - s * f);</a>
<a name="ln372">            var t = v * (1.0 - s * (1.0 - f));</a>
<a name="ln373"> </a>
<a name="ln374">            switch (i)</a>
<a name="ln375">            {</a>
<a name="ln376">                case 0:</a>
<a name="ln377">                    r = v;</a>
<a name="ln378">                    g = t;</a>
<a name="ln379">                    b = p;</a>
<a name="ln380">                    break;</a>
<a name="ln381"> </a>
<a name="ln382">                case 1:</a>
<a name="ln383">                    r = q;</a>
<a name="ln384">                    g = v;</a>
<a name="ln385">                    b = p;</a>
<a name="ln386">                    break;</a>
<a name="ln387"> </a>
<a name="ln388">                case 2:</a>
<a name="ln389">                    r = p;</a>
<a name="ln390">                    g = v;</a>
<a name="ln391">                    b = t;</a>
<a name="ln392">                    break;</a>
<a name="ln393"> </a>
<a name="ln394">                case 3:</a>
<a name="ln395">                    r = p;</a>
<a name="ln396">                    g = q;</a>
<a name="ln397">                    b = v;</a>
<a name="ln398">                    break;</a>
<a name="ln399"> </a>
<a name="ln400">                case 4:</a>
<a name="ln401">                    r = t;</a>
<a name="ln402">                    g = p;</a>
<a name="ln403">                    b = v;</a>
<a name="ln404">                    break;</a>
<a name="ln405"> </a>
<a name="ln406">                default:</a>
<a name="ln407">                    r = v;</a>
<a name="ln408">                    g = p;</a>
<a name="ln409">                    b = q;</a>
<a name="ln410">                    break;</a>
<a name="ln411">            }</a>
<a name="ln412">        }</a>
<a name="ln413"> </a>
<a name="ln414">        return Color.FromArgb((byte)alpha, (byte)(r * 255), (byte)(g * 255), (byte)(b * 255));</a>
<a name="ln415">    }</a>
<a name="ln416"> </a>
<a name="ln417">    /// &lt;summary&gt;</a>
<a name="ln418">    /// Generates a list of colors with hues ranging from 0-360 and a saturation and value of 1.</a>
<a name="ln419">    /// &lt;/summary&gt;</a>
<a name="ln420">    /// &lt;returns&gt;The List of Colors&lt;/returns&gt;</a>
<a name="ln421">    public static List&lt;Color&gt; GenerateHsvSpectrum(int count)</a>
<a name="ln422">    {</a>
<a name="ln423">        var colorsList = new List&lt;Color&gt;();</a>
<a name="ln424"> </a>
<a name="ln425">        var stop = 360d / count;</a>
<a name="ln426">        var isDecimal = stop % 1 &gt; 0;</a>
<a name="ln427">            </a>
<a name="ln428">        for (var i = 0; i &lt;= (isDecimal ? count - 1 : count); i++)</a>
<a name="ln429">            colorsList.Add(ConvertHsvToRgb(i * stop, 1, 1, 255));</a>
<a name="ln430"> </a>
<a name="ln431">        if (isDecimal)</a>
<a name="ln432">            colorsList.Add(ConvertHsvToRgb(360, 1, 1, 255));</a>
<a name="ln433"> </a>
<a name="ln434">        //for (var i = 0; i &lt; 29; i++)</a>
<a name="ln435">        //    colorsList.Add(ConvertHsvToRgb(i * 12, 1, 1, 255));</a>
<a name="ln436"> </a>
<a name="ln437">        //colorsList.Add(ConvertHsvToRgb(0, 1, 1, 255));</a>
<a name="ln438">        return colorsList;</a>
<a name="ln439">    }</a>
<a name="ln440"> </a>
<a name="ln441">    /// &lt;summary&gt;</a>
<a name="ln442">    /// Generates a list of colors with transparency ranging from 0-255.</a>
<a name="ln443">    /// &lt;/summary&gt;</a>
<a name="ln444">    public static List&lt;Color&gt; GenerateAlphaSpectrum(Color color, int count = 2)</a>
<a name="ln445">    {</a>
<a name="ln446">        var colorsList = new List&lt;Color&gt;();</a>
<a name="ln447"> </a>
<a name="ln448">        var stop = 255d / count;</a>
<a name="ln449">        var isDecimal = stop % 1 &gt; 0;</a>
<a name="ln450"> </a>
<a name="ln451">        for (var i = 0; i &lt;= (isDecimal ? count - 1 : count); i++)</a>
<a name="ln452">            colorsList.Add(Color.FromArgb((byte)(i * stop), color.R, color.G, color.B));</a>
<a name="ln453"> </a>
<a name="ln454">        if (isDecimal)</a>
<a name="ln455">            colorsList.Add(Color.FromArgb(255, color.R, color.G, color.B));</a>
<a name="ln456"> </a>
<a name="ln457">        colorsList.Reverse();</a>
<a name="ln458"> </a>
<a name="ln459">        return colorsList;</a>
<a name="ln460">    }</a>
<a name="ln461"> </a>
<a name="ln462">    public static System.Drawing.Color ToDrawingColor(this Color color) =&gt; System.Drawing.Color.FromArgb(color.A, color.R, color.G, color.B);</a>
<a name="ln463">}</a>
</code></pre>
<div class="balloon" rel="80"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: num == num4. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="82"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: num2 == num4. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="84"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: num3 == num4. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="109"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: num4 == num5. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="133"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: n == diffMin. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="212"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: n == diffMin. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="269"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: v == 0.0. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="274"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: s == 0. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="278"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: color.R == v. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="280"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: color.G == v. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="282"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: color.B == v. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="313"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: v == 0.0. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="318"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: s == 0. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="322"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: r == v. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="324"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: g == v. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="326"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: b == v. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="354"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: s == 0. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<div class="balloon" rel="362"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3024/" target="_blank">V3024</a> An odd precise comparison: h == 360. Consider using a comparison with defined precision: Math.Abs(A - B) &lt; Epsilon.</p></div>
<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>